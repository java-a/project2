# Project 2: 斗兽棋

## 项目目标

在 Project 1 中，同学们都基本实现了一个命令行界面的斗兽棋小游戏。Project 2 延续Project1的内容，主要是需要做GUI扩展和部分进阶功能，使得我们这个游戏 更具有娱乐性、可玩性。

我们将Project2中所有需要实现的内容分为逻辑和界面。在 Project 1 中，同学们基本上已经完成了大部分的逻辑操作，这次只需要对一部分原来没有实现和对未完善的部分进行完善，着重要对重构代码和使用面向对象设计的部分花比较多的时间。而对图形化界面的部分，推荐大家仿造[野兽争霸斗兽棋]([http://flash.7k7k.com/cms/cms10/20120717/1546039028/95197/index.html](http://flash.7k7k.com/cms/cms10/20120717/1546039028/95197/index.html))的单机对战部分，其素材在`resources`文件夹中给出。不过大家可以自由发挥，打造属于你自己的斗兽棋，只要展示清晰、明了即可。

## 基本要求

### 重构代码

大部分同学的pj1代码可以通过重构来提高代码质量。

pj2对代码风格有以下三点具体要求：

1. 单个方法的长度不应超过300行（如有特殊情况可向助教提出）。
2. 方法名和变量名命名得当。
3. 方法和类的作用与意义清晰明确。
4. 逻辑和界面分开设计，不要把他们混着写在一个很大的类里

### 面向对象设计

使用面向对象的思想来设计代码结构是pj2的重点要求。在同学们动手写pj2代码之前，助教建议同学们根据所学知识，设计好pj2基础功能的每个类。

推荐同学们将自己设计的**逻辑部分**的每个类以文档的方式记录下来。内容包括：

1. 类名、类的意义和作用。
2. 类的父类、子类和接口，以及这么设计的理由。（如果有）
3. 类的构造函数、可见域和可见方法以及它们的作用。（最主要的一点，体现封装的概念）
4. 类的私有域及其作用。（可以只列出关键的几个）
5. 类的私有方法。（这个不一定需要）
6. 其他有必要提及的内容，比如和其他某个类之间的联系

以[第三次视频](http://www.bilibili.com/video/av7215301/)中的GameHistory类为例：

```java
类名：GameHistory
  
意义和作用：记录所有游戏历史，并提供悔棋、取消悔棋功能。
  
(没有父类和子类，也不实现特定接口)
  
类的构造方法：
1. public GameHistory();
作用：初始化所有私有域。
  
类的可见域：无
  
类的可见方法：
1. public void addRecord(String[][] board);
作用：复制board并添加入历史记录中。
2. public void undo(String[][] board);
作用：悔棋，并将悔棋后的棋盘写入board中。
3. public void redo(String[][] board);
作用：悔棋，并将取消悔棋后的棋盘写入board中。
4. public void restart();
作用：重新开始游戏时调用，清空并重新初始化历史纪录。
  
类的私有域：
1. private String[][][] boardHistory;
作用：记录所有的游戏历史。
2. private int currentStep;
作用：记录当前游戏地图在boardHistory中的位置。
3. private int lastStep;
作用：记录boardHistory中最后一步的位置。
  
类的私有方法：
视频中无，但是可以有一个copyBoard方法，即出现过三次的两层for循环可以提取出一个 private void copyBorad(String[][] from, String[][] to); 方法，减少代码重复性。
```

像这样的一份文档可以在写代码时提供很大帮助，并且其中的文字大多可以作为注释、文档的材料。

初步设计完后，同学们可以将自己的设计与助教和其他同学一起讨论，看看设计是否合理，有什么需要改进的地方。

在实际写代码的过程中，同学们很可能要经常修改自己的设计，希望同学们在修改设计的时候一并修改此文档。

### 图形化界面

图形化界面是pj2相比pj1最明显的升级，也是pj2中最有趣的部分。具备了图形化界面后，同学们的斗兽棋会变得更加有趣。

图形化界面部分自由度较高，同学们可以在此充分发挥自己的想象力和创造力。

#### 游戏地图

游戏地图为pic目录下的Map1.png，Map2.png和Map3.png。同学们根据自己的界面需要选取其中一张，或在其基础上修改，或自己设计一张。

#### 动物图片

动物图片在pic目录下的animals目录下，并分为左右两侧。相比我们参考的flash版本，助教没有提供动物图片的“红色”版本，同学们可以自由发挥如何标识动物是否处于可以操作的状态（不标识也可以，但要在明确显示现在轮到哪一方移动）。

#### 动物移动

动物移动使用鼠标控制，与参考程序相同，点击一个动物，再点击移动至某个地块。此处请注意合法性判断。

如果有同学想对动物移动的操作方法进行改变，请联系助教。其中，只通过键盘输入1w, 4d等字符串来进行移动是非常不推荐的，会被扣一部分分数。

基础功能中，不要求点击动物后显示其可以移动的地块，这个功能作为拓展功能的可选项。

#### 帮助、重新开始、退出功能

这三个功能要求实现，具体实现方式由同学们自己定义，合理即可。

同学们可以创建菜单栏，将这些功能放入菜单中，也可以设置几个按钮，放在合适的地方。

#### 游戏胜利

胜利条件判断与pj1相同。

胜利提示或胜利界面由同学们自己定义，合理即可。

#### 悔棋、取消悔棋

考虑到作为一个游戏的正常逻辑，取消悔棋功能可以不在图形化界面中提供，但悔棋功能必须实现。

悔棋功能不再要求只能悔棋一步，同学们可以按照自己对游戏悔棋功能的理解提供悔棋功能。可以悔棋一步，可以悔棋两步，可以由一方提出并等待对面同意，合理即可。

## 拓展功能

pj2要求同学们实现两个拓展功能。拓展功能没有硬性要求，同学们可以自由发挥，但注意不要跑偏太远。

拓展功能部分共15分。每个拓展功能占6分，排名分占3分，6+6+3=15。

助教在评分时，会对每个拓展功能作出0-10分的评价，获得6分或6分以上，该拓展功能即可获得满分6分。

排名分则是同学们需要冲刺的分数，助教会将同学们的两个拓展功能分（10分制）相加，全班排名前5的同学将获得3分满分，排名6-20名的同学将获得2分，其余同学获得1分。

注：若实现多于两个拓展功能，助教会取其中成绩最高的两个。

### 推荐的拓展功能

#### 存档、读档功能

玩家可以将目前的游戏状态存入文件中，并可以通过读取文件来继续之前的游戏。

深度挖掘：读取后的游戏能否支持悔棋？

#### 计时、超时功能

计时、超时功能可以包括：游戏进行的总时长计时、玩家单步操作思考时长限制、玩家思考总时长限制等，并给予恰当的超时惩罚。

#### 智能提示

例如：

当点击一个动物时，显示其可以移动的位置。

当己方一个动物处于危险中（比如对方老鼠走到了己方大象旁边）时给予提示。

#### 好看的界面

自由发挥~展现你的设计与创意~

注意：纯粹的美工与设计原则上不能取得大于8分的成绩，需要有代码上的难度才能取得最高的分数，比如结合代码和美术素材实现动画效果等。

#### 音效

助教给的资源中包括了音效，尝试将其应用到游戏中吧~

注：这个功能比较难深挖，所以取得高分可能有些困难，但拿到6分会比较容易。

#### 科学的Git使用

Git可远远不止上传GitHub这个功能，在开发过程中，合理使用Git进行版本控制，是非常好的开发习惯。

### 不推荐的拓展功能

这部分不推荐的原因主要是因为难度过高，同学们容易花太多时间在这些拓展功能上。

#### 网络对战功能

较难。如果是通过手动输入ip的方式，还稍简单一些。但如果想实现像[doushouqi.net](doushouqi.net)这样的网络对战功能，难度过高，非常不推荐。

#### AI功能

Artificial Intelligence，难度较高，而且网上基本上没有关于如何写斗兽棋AI的文章，所以不推荐做这个功能。

#### 3D界面

不仅难，而且麻烦，不推荐。

#### 使用游戏引擎

学习成本相当高，有时间且技术水平高的同学谨慎尝试。

#### VR，AR功能

跟上一条比较像，都是这届三叶草软件竞赛的主题，但是难度较高，而且2D的斗兽棋好像也比较难做出类似的功能。

## 评分标准

1. 代码风格：10分
2. 面向对象设计：20分
3. 图形化界面：40分
4. 拓展功能：15分
5. 设计文档：7分
6. 用户手册：4分
7. 面试情况：4分

## 提交与面试

未定，预计为最后一次lab课的日期。